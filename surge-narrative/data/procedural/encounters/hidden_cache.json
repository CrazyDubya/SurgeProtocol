{
  "encounter_id": "p1_hidden_cache",
  "category": "positive",
  "subcategory": "resource_find",
  "title": "Hidden Cache",
  "tier_range": {
    "min": 1,
    "max": 4
  },
  "trigger": {
    "type": "exploration",
    "location_types": ["hollows", "harbor", "abandoned_areas"],
    "base_frequency": 0.03
  },
  "frequency_modifiers": [
    {
      "condition": "skill",
      "skill": "perception",
      "threshold": 6,
      "modifier": 1.5
    },
    {
      "condition": "flag",
      "flag": "FOUND_HIDDEN_CACHE",
      "modifier": 0.5,
      "description": "Less likely after first find"
    }
  ],
  "setup": {
    "description": "Something catches your eye. A loose panel. A suspicious shadow. Behind itâ€”someone's emergency stash, abandoned or forgotten.",
    "atmosphere": "discovery_excitement"
  },
  "discovery_variants": [
    {
      "id": "wall_panel",
      "description": "Loose wall panel in maintenance corridor",
      "location_weight": {"hollows": 1.5}
    },
    {
      "id": "floor_compartment",
      "description": "Hidden floor compartment under debris",
      "location_weight": {"harbor": 1.5}
    },
    {
      "id": "pipe_cache",
      "description": "Weatherproof container in drainage pipe",
      "location_weight": {"any": 1.0}
    }
  ],
  "contents": {
    "credits": {
      "range": {"min": 150, "max": 400},
      "tier_scaling": 1.3
    },
    "items": {
      "pool": [
        {
          "id": "medical_supplies",
          "name": "Medical Supplies",
          "weight": 0.4,
          "value_range": {"min": 50, "max": 150}
        },
        {
          "id": "chrome_components",
          "name": "Chrome Components",
          "weight": 0.3,
          "value_range": {"min": 75, "max": 200}
        },
        {
          "id": "data_chip",
          "name": "Encrypted Data Chip",
          "weight": 0.2,
          "special": true,
          "may_trigger_quest": true
        },
        {
          "id": "weapon",
          "name": "Concealed Weapon",
          "weight": 0.1,
          "tier_min": 2
        }
      ],
      "items_found": {"min": 1, "max": 3}
    }
  },
  "player_options": [
    {
      "id": "take_all",
      "text": "Take everything",
      "type": "action",
      "outcome": "take_all_outcome"
    },
    {
      "id": "take_partial",
      "text": "Take only what you need",
      "type": "action",
      "karma_impact": 2,
      "outcome": "take_partial_outcome"
    },
    {
      "id": "leave_it",
      "text": "Leave it for whoever needs it",
      "type": "action",
      "karma_impact": 5,
      "outcome": "leave_outcome"
    },
    {
      "id": "investigate",
      "text": "Check for owner information",
      "type": "skill_check",
      "skill": "perception",
      "difficulty": 6,
      "success_outcome": "investigate_success",
      "failure_outcome": "investigate_failure"
    }
  ],
  "outcomes": {
    "take_all_outcome": {
      "description": "You pocket everything. Finders keepers.",
      "effects": [
        {"type": "gain_credits", "source": "cache_credits"},
        {"type": "gain_items", "source": "cache_items"},
        {"type": "set_flag", "flag": "FOUND_HIDDEN_CACHE", "value": true}
      ]
    },
    "take_partial_outcome": {
      "description": "You take what helps and leave the rest.",
      "effects": [
        {"type": "gain_credits", "amount_modifier": 0.5},
        {"type": "gain_items", "count": 1},
        {"type": "karma_mod", "value": 2},
        {"type": "set_flag", "flag": "FOUND_HIDDEN_CACHE", "value": true}
      ]
    },
    "leave_outcome": {
      "description": "You close the cache and walk away. Someone else might need it more.",
      "effects": [
        {"type": "karma_mod", "value": 5},
        {"type": "set_flag", "flag": "FOUND_HIDDEN_CACHE", "value": true}
      ],
      "chain_hook": {
        "probability": 0.3,
        "event": "grateful_cache_owner",
        "delay_hours": {"min": 24, "max": 72}
      }
    },
    "investigate_success": {
      "description": "You find a name scratched inside: '{NPC_NAME}'. Someone from the neighborhood.",
      "effects": [
        {"type": "learn_npc_info", "info_type": "cache_owner"}
      ],
      "additional_options": [
        {
          "id": "return_to_owner",
          "text": "Try to find the owner",
          "karma_impact": 10,
          "outcome": "return_outcome"
        }
      ],
      "returns_to": "player_options"
    },
    "investigate_failure": {
      "description": "No identifying marks. Just supplies someone stockpiled.",
      "returns_to": "player_options"
    },
    "return_outcome": {
      "description": "You track down the owner and return their emergency stash.",
      "effects": [
        {"type": "karma_mod", "value": 10},
        {"type": "reputation_mod", "district": "local", "value": 5},
        {"type": "small_reward_from_npc"},
        {"type": "potential_contact_gained"}
      ],
      "chain_hook": {
        "probability": 0.5,
        "quest_hook": "cache_owner_needs_help"
      }
    }
  },
  "voice_requirements": {
    "lines_needed": 0,
    "note": "Primarily narration-based encounter"
  },
  "chain_hooks": {
    "potential_chains": [
      {
        "condition": "data_chip_found",
        "quest_hook": "mysterious_data",
        "probability": 0.4
      },
      {
        "condition": "leave_outcome",
        "quest_hook": "grateful_stranger",
        "probability": 0.3
      }
    ]
  },
  "metadata": {
    "source_file": "/11_PROCEDURAL/encounters/positive_encounters.md",
    "phase": 7,
    "day": 11
  }
}
